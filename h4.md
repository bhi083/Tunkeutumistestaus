# h4 Fuzzy

## x) Tiivistelmät

### Karvinen 2025: [Tunkeutumistestaus](https://terokarvinen.com/tunkeutumistestaus/#h4-fuzzy)

- Ffuf on suomalaisen joohoin tekemä web fuzzaus työkalu
- Fuzzatessa ffuffilla tuloksia voi ja pitääkin rajata, jotta järkevät vastaukset saadaan selville.

### Hoikkala 2023: [ffuf README.md](https://github.com/ffuf/ffuf/blob/master/README.md)

- ffuf on kirjoitettu Go-kielellä
- Voi etsiä directoreja, joita ei ole linkattu mihinkään
- Ffufin tuloksiin voi vaikuttaa useilla eri parametreillä
- Prosessin aikana painamalla Enter voi muokata kesken prosessin

## a) Fuzzzzz

Käynnistin maalin tehtäväohjeiden mukaisesti. Kokeilin ensin ffufia ilman erillisiä parametrejä.

    $ ffuf -w common.txt -u http://127.0.0.2:8000/FUZZ

Tuloksena tuli liikaa vastauksia:

<img width="1175" height="1418" alt="Näyttökuva 2025-09-15 132915" src="https://github.com/user-attachments/assets/ef59abfb-d157-4b64-82c2-962a59e8e844" />

Huomasin, että suurimmassa osassa size oli 154, joten filtteröin ne pois lisäämällä komentoon -fs 154.

<img width="1203" height="797" alt="Näyttökuva 2025-09-15 132903" src="https://github.com/user-attachments/assets/bb31d449-8ace-4846-b751-02482e88da76" />

Tuloksissa oli käytännössä kaksi eri hyödyllistä vaihtoehtoa, .git -loppuiset URLIt, ja wp-admin. Kokeilin molempia ja sain flagit.

<img width="900" height="403" alt="Näyttökuva 2025-09-15 132754" src="https://github.com/user-attachments/assets/12761e90-a7cd-4d2c-897a-b753ec361282" />

<img width="843" height="368" alt="Näyttökuva 2025-09-15 132856" src="https://github.com/user-attachments/assets/75820b65-2b6d-41c6-b67b-6c7f623203b0" />

## b) Fuff me

Asensin FuffMe-harjoitusmaalin. Tästä ei oikeastaan raportoitavaa, ajoin kommenot annettujen ohjeiden mukaan ja kaikki toimi ensimmäisellä kerralla.

<img width="498" height="100" alt="Näyttökuva 2025-09-15 134117" src="https://github.com/user-attachments/assets/cdc3bad8-85a4-4aba-9664-be1b35ad73e6" />


## c) Basic content discovery

Ez pz. Tämä on tässä vaiheessa jo vähän pakko osata.

<img width="1159" height="642" alt="Näyttökuva 2025-09-15 134018" src="https://github.com/user-attachments/assets/41e925ba-e040-4dc6-a0f2-7022500e8de7" />

## d) Recursion

-recursion -parametri kertoo ffufille, että sen pitää löytäessään kohteen lisätä kohde URLiin ja jatkaa hakua sen päästä. Eli tässä viimeinen maali oli /admin/users/96

<img width="1247" height="865" alt="Näyttökuva 2025-09-15 134448" src="https://github.com/user-attachments/assets/47543864-1194-4e4a-a950-36715986d680" />

## e) File Extensions

-e .log - parametrin avulla voimme etsiä tietyn tyyppisiä tiedostoja. Parametri lisää jokaisen haun loppuun .log.

<img width="1196" height="648" alt="Näyttökuva 2025-09-15 134728" src="https://github.com/user-attachments/assets/9c6a7818-222d-430f-8578-8a484e91c4b0" />

## f) No 404

Näyttökuvan fuzz antaa aivan liian monta vastausta, koska yksikään ei lähetä 404 koodia, vaikka sivuja ei ole olemassa. 

<img width="1190" height="1117" alt="Näyttökuva 2025-09-15 134958" src="https://github.com/user-attachments/assets/81f8d353-385c-428d-ba28-237137ab887a" />

Kokeillaan rajata kaikki samankokoiset tulokset pois:

<img width="1178" height="641" alt="Näyttökuva 2025-09-15 135139" src="https://github.com/user-attachments/assets/082c7a22-3a1a-4935-8598-5fc6ee9f9503" />

Naughty secrets!

## g) Param mining

Puuttuva parametri ei kovinkaan paljon eroa URLista muutenkaan.

<img width="1181" height="628" alt="Näyttökuva 2025-09-15 135407" src="https://github.com/user-attachments/assets/f1da6c14-52e2-49fc-887d-e29babb33cf0" />

<img width="791" height="179" alt="Näyttökuva 2025-09-15 135345" src="https://github.com/user-attachments/assets/a3b602d8-3cd8-46a8-80cd-04260e036a96" />

## h) Rate limited

Palvelussa on rajoitin, joka estää useiden pyyntöjen lähettämisen nopeasti putkeen. Parametri -mc 200,429 näyttää 429-koodiset vastaukset, joka kertoo että hetkeen ei voi tehdä uusia pyyntöjä.

<img width="1235" height="808" alt="Näyttökuva 2025-09-15 135937" src="https://github.com/user-attachments/assets/22c8fc5e-1c24-42d7-859a-84ad9a660534" />

Lisäämällä -t 5 ja -p 0.1 ffuf pysähtyy pyyntöjen välillä 0.1 sekunniksi ja fuzzaa käytännössä viidelltä eri ffufilta samanaikaisesti, jotta rate limiter ei toimi. Saadaan haluttu oracle:

<img width="1218" height="631" alt="Näyttökuva 2025-09-15 140246" src="https://github.com/user-attachments/assets/aaa942a4-016b-4d96-9256-62125e091c89" />

## i) Subdomains - Virtual host enumeration

Sain tehtävän tehtyä, vaikka en ihan rehellisesti sanottuna ymmärtänyt, mitä -H tekee.

<img width="1270" height="837" alt="Näyttökuva 2025-09-15 140649" src="https://github.com/user-attachments/assets/bac46f0f-2f69-4a71-a698-b1500bddeee2" />

<img width="1267" height="672" alt="Näyttökuva 2025-09-15 140634" src="https://github.com/user-attachments/assets/430b6cfb-08b6-4a1b-b48a-76abff0b3088" />

## Lähteet

Karvinen 2025: [Tunkeutumistestaus](https://terokarvinen.com/tunkeutumistestaus/#h4-fuzzy)

Karvinen 2023: [Find Hidden Web Directories - Fuzz URLs with ffuf](https://terokarvinen.com/2023/fuzz-urls-find-hidden-directories/)

Karvinen 2023: [Fuffme - Install Web Fuzzing Target on Debian](https://terokarvinen.com/2023/fuffme-web-fuzzing-target-debian/?fromSearch=fuff)

Hoikkala 2023: [ffuf README.md](https://github.com/ffuf/ffuf/blob/master/README.md)
